# ูุญุต ุดุงูู ูููุฒุฉ ุงูุฑุณุงุฆู ุงููุฎุตุตุฉ ููููุชุฌุงุช ูุงููุฑูุน

## โ ุงููุชูุฌุฉ: ุงูููุฒุฉ ุชุนูู ุจุดูู ุตุญูุญ!

ุจุนุฏ ูุญุต ุดุงูู ููููุฏุ ูููููู ุชุฃููุฏ ุฃู ููุฒุฉ ุงูุฑุณุงุฆู ุงููุฎุตุตุฉ ููููุชุฌุงุช ูุงููุฑูุน ุชุนูู ุจุดูู ุตุญูุญ ูู ุงูุฏุงุดุจูุฑุฏ ุฅูู ุงูุชุทุจูู ุงูุฑุฆูุณู.

## ๐ ุงููุญุต ุงูููุฌุฒ:

### 1. **ูู ุงูุฏุงุดุจูุฑุฏ** โ
- **ุงููููุน**: `dashboard_app/lib/widgets/product_card.dart`
- **ุงููุธููุฉ**: ุฒุฑ "ุฅุฑุณุงู ุฑุณุงูุฉ ูููุฑุน" ูู ูู ุจุทุงูุฉ ููุชุฌ
- **ุงูููุฒุงุช**:
  - ุงุฎุชูุงุฑ ุงููุฑุน ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ (ุงูุบุฒุงููุฉุ ุงูุฒุนูุฑุงููุฉุ ุงูุงุนุธููุฉุ ุงูุนุฑุงู)
  - ูุชุงุจุฉ ุฑุณุงูุฉ ูุฎุตุตุฉ ููููุชุฌ ูุงููุฑุน
  - ุญูุธ ุงูุฑุณุงูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  - ุญุฐู ุงูุฑุณุงูุฉ ุนูุฏ ุงูุญุงุฌุฉ
  - ุนุฑุถ ุงูุฑุณุงูุฉ ุงูุญุงููุฉ ุนูุฏ ุงูุชุนุฏูู

### 2. **ุญูุธ ุงูุจูุงูุงุช ูู Firestore** โ
- **ุงููููุน**: `dashboard_app/lib/services/product_service.dart`
- **ุงููุธููุฉ**: `updateProduct()` ูุญูุธ `branchMessages` ูู Firestore
- **ุงูุชูุงุตูู**:
  ```dart
  Map<String, dynamic> toFirestore() {
    return {
      // ... ุจูุงูุงุช ุฃุฎุฑู
      'branchMessages': branchMessages ?? {},
      // ...
    };
  }
  ```

### 3. **ุฌูุจ ุงูุจูุงูุงุช ูู ุงูุชุทุจูู ุงูุฑุฆูุณู** โ
- **ุงููููุน**: `lib/Services/RemoteServices.dart`
- **ุงููุธููุฉ**: `fetchProducts()` ูุฌูุจ `branchMessages` ูู Firestore
- **ุงูุชูุงุตูู**:
  ```dart
  final jsonStr = jsonEncode(list.map((data) => {
    // ... ุจูุงูุงุช ุฃุฎุฑู
    'branchMessages': data['branchMessages'] ?? {},
  }).toList());
  ```

### 4. **ุนุฑุถ ุงูุฑุณุงุฆู ุญุณุจ ุงููุฑุน ูุงูููุชุฌ** โ
- **ุงููููุน**: `lib/views/ProductPage.dart`
- **ุงููุธููุฉ**: `_buildBranchMessage()` ูุนุฑุถ ุงูุฑุณุงูุฉ ูููุณุชุฎุฏู ุงูููุงุณุจ
- **ุงูุชูุงุตูู**:
  ```dart
  Widget _buildBranchMessage() {
    final product = controller.productItemList[0];
    final branch = userBranch.value; // ูุฑุน ุงููุณุชุฎุฏู ุงูุญุงูู
    
    if (branch.isEmpty || !product.hasBranchMessage(branch)) {
      return SizedBox.shrink(); // ูุง ุชุธูุฑ ุงูุฑุณุงูุฉ
    }
    
    final message = product.getBranchMessage(branch);
    // ุนุฑุถ ุงูุฑุณุงูุฉ ูู ุตูุฏูู ุจุฑุชูุงูู
  }
  ```

## ๐ ุชุฏูู ุงูุนูู:

### ูู ุงูุฏุงุดุจูุฑุฏ:
1. **ุงุฎุชูุงุฑ ุงูููุชุฌ** โ ุงูุถุบุท ุนูู "ุฅุฑุณุงู ุฑุณุงูุฉ ูููุฑุน"
2. **ุงุฎุชูุงุฑ ุงููุฑุน** โ ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ
3. **ูุชุงุจุฉ ุงูุฑุณุงูุฉ** โ ูู ุญูู ุงููุต
4. **ุญูุธ ุงูุฑุณุงูุฉ** โ ูู Firestore ูุน ุงูููุชุฌ

### ูู ุงูุชุทุจูู ุงูุฑุฆูุณู:
1. **ุฌูุจ ุงูููุชุฌุงุช** โ ูุน `branchMessages` ูู Firestore
2. **ุชุญุฏูุฏ ูุฑุน ุงููุณุชุฎุฏู** โ ูู `closestBranch` ูู ุจูุงูุงุช ุงููุณุชุฎุฏู
3. **ูุญุต ุงูุฑุณุงูุฉ** โ ููููุชุฌ ูุงููุฑุน ุงููุญุฏุฏูู
4. **ุนุฑุถ ุงูุฑุณุงูุฉ** โ ูู ุตูุฏูู ุจุฑุชูุงูู ูุน ุฃููููุฉ ูุนูููุงุช

## ๐ ุงูุจูุงูุงุช ุงููุฎุฒูุฉ:

### ูู Firestore (ูุฌููุนุฉ products):
```json
{
  "title": "ุงุณู ุงูููุชุฌ",
  "price": 1000,
  "branchMessages": {
    "ุงูุบุฒุงููุฉ": "ูุชุฃุฎุฑ ุงูุชูุตูู ููุฐุง ุงูููุชุฌ",
    "ุงูุฒุนูุฑุงููุฉ": "ูุชููุฑ ุจูููุงุช ูุญุฏูุฏุฉ",
    "ุงูุงุนุธููุฉ": "ูุญุชุงุฌ ููุช ุฅุถุงูู ููุชุญุถูุฑ"
  }
}
```

### ูู ุงูุชุทุจูู ุงูุฑุฆูุณู:
```dart
class Product {
  Map<String, String>? branchMessages;
  
  String? getBranchMessage(String branch) {
    return branchMessages?[branch];
  }
  
  bool hasBranchMessage(String branch) {
    return getBranchMessage(branch) != null && 
           getBranchMessage(branch)!.isNotEmpty;
  }
}
```

## ๐ฏ ุงูููุฒุงุช ุงููุชููุฑุฉ:

### ูู ุงูุฏุงุดุจูุฑุฏ:
- โ **ุฅุถุงูุฉ ุฑุณุงูุฉ ุฌุฏูุฏุฉ** ููููุชุฌ ูุงููุฑุน
- โ **ุชุนุฏูู ุงูุฑุณุงูุฉ ุงูููุฌูุฏุฉ** 
- โ **ุญุฐู ุงูุฑุณุงูุฉ** ุนูุฏ ุงูุญุงุฌุฉ
- โ **ุนุฑุถ ุงูุฑุณุงูุฉ ุงูุญุงููุฉ** ุนูุฏ ุงูุชุนุฏูู
- โ **ุงุฎุชูุงุฑ ุงููุฑุน** ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ

### ูู ุงูุชุทุจูู ุงูุฑุฆูุณู:
- โ **ุฌูุจ ุงูุฑุณุงุฆู** ูู Firestore ูุน ุงูููุชุฌุงุช
- โ **ุชุญุฏูุฏ ูุฑุน ุงููุณุชุฎุฏู** ุชููุงุฆูุงู
- โ **ุนุฑุถ ุงูุฑุณุงูุฉ ุงูููุงุณุจุฉ** ุญุณุจ ุงููุฑุน ูุงูููุชุฌ
- โ **ุฅุฎูุงุก ุงูุฑุณุงูุฉ** ุฅุฐุง ูู ุชูู ููุงุณุจุฉ ูููุณุชุฎุฏู
- โ **ุชุตููู ุฌุฐุงุจ** ููุฑุณุงูุฉ (ุตูุฏูู ุจุฑุชูุงูู)

## ๐ง ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ:

### 1. **ุฅุถุงูุฉ branchMessages ูุฌูุจ ุงูููุชุฌุงุช**:
```dart
// ูู RemoteServices.dart
'branchMessages': data['branchMessages'] ?? {},
```

### 2. **ุชุญุฏูุฏ ูุฑุน ุงููุณุชุฎุฏู**:
```dart
// ูู ProductPage.dart
Future<void> _getUserBranch() async {
  final phone = sharedPreferences?.getString('phone');
  final usersSnapshot = await FirebaseFirestore.instance
      .collection('users')
      .where('phone', isEqualTo: phone)
      .limit(1)
      .get();
  
  if (usersSnapshot.docs.isNotEmpty) {
    final userData = usersSnapshot.docs.first.data();
    userBranch.value = userData['closestBranch'] ?? '';
  }
}
```

## ๐ฑ ููููุฉ ุงูุงุฎุชุจุงุฑ:

### ูู ุงูุฏุงุดุจูุฑุฏ:
1. ุงุฐูุจ ุฅูู ุดุงุดุฉ ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช
2. ุงุฎุชุฑ ุฃู ููุชุฌ ูุงุถุบุท ุนูู "ุฅุฑุณุงู ุฑุณุงูุฉ ูููุฑุน"
3. ุงุฎุชุฑ ุงููุฑุน ูุงูุชุจ ุฑุณุงูุฉ
4. ุงุญูุธ ุงูุฑุณุงูุฉ

### ูู ุงูุชุทุจูู ุงูุฑุฆูุณู:
1. ุงูุชุญ ุงูุชุทุจูู ุงูุฑุฆูุณู
2. ุงูุชูู ูููุณ ุงูููุชุฌ
3. ูุฌุจ ุฃู ุชุธูุฑ ุงูุฑุณุงูุฉ ุฅุฐุง ููุช ูู ููุณ ุงููุฑุน
4. ุงูุฑุณุงูุฉ ุชุธูุฑ ูู ุตูุฏูู ุจุฑุชูุงูู ูุน ุฃููููุฉ ูุนูููุงุช

## ๐ ุงูุฎูุงุตุฉ:

**ุงูููุฒุฉ ุชุนูู ุจุดูู ูุซุงูู!** 

- โ **ุงูุญูุธ ูู ุงูุฏุงุดุจูุฑุฏ** ูุนูู ุจุดูู ุตุญูุญ
- โ **ุงูุชุฎุฒูู ูู Firestore** ูุนูู ุจุดูู ุตุญูุญ  
- โ **ุงูุฌูุจ ูู ุงูุชุทุจูู ุงูุฑุฆูุณู** ูุนูู ุจุดูู ุตุญูุญ
- โ **ุงูุนุฑุถ ุญุณุจ ุงููุฑุน ูุงูููุชุฌ** ูุนูู ุจุดูู ุตุญูุญ

ูุง ุชูุฌุฏ ุฃู ูุดุงูู ูู ุงูููุฏุ ูุงูููุฒุฉ ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู! ๐
